* 本文主要内容为**刘超**老师在极客时间上的《趣谈网络协议》课程学习笔记


## 1. 物理层基本概念

物理层考虑的是如何在连接各种计算机的传输媒体上传输数据比特流，不是具体的传输媒体。


物理层的主要任务是 ： 确定与传输媒体接口的一些特性。




### 1. 物理层下面的传输媒体：

传输媒体 ： 数据传输系统中发送器和接收器之间的物理通路


1. 导引型传输媒体 ： 电磁波沿着固体媒体传播 (光纤或者双绞线)



2. 非导引型传输媒体： 电磁波无线传输 （微波通信）



### 2. 数据通信模型


![](https://i.loli.net/2019/10/01/k5cf8d3lbqmjsvw.jpg)

数据通信系统主要包含 ： 源系统，传输系统和目的系统








## 2. 数据链路层

### 1. 基本概念 ：


#### 1. 数据链路 ：

* 链路是指结点到相邻结点的一段物理线路

* 数据链路 ： 物理链路上面的一些必要的通信协议


#### 2. 数据链路层的协议单元 --- 帧

需要把网络层传下来的数据构成帧发送到物理层，也要把来自物理层的帧中的数据去处交给网络层。

网络层的数据称为 IP 数据报，对数据报加入首部和尾部即封装为 帧


#### 3. 三个基本问题：


1. 封装成帧



2. 透明传输



3. 差错检测



### 2. 点对点传输协议 ： PPP









### 3. 广播信道 ：












---



## 2. 搭建一个局域网

局域网虽然是一个网络， 但是并不放在网络层， 因为网络层主要是将分组从一个网络通过路由器转发到另一个网络。 同一个局域网主要研究从一个主机传送到另一个主机，不经过路由器。主要是数据链路层。



### 物理层 -- 第一层

#### 1. 两个电脑  建局域网 --- LAN


* 一个网线，连接两个电脑的网卡，实现一端发送信号，另一端可以接收到。

* 配置两台电脑的 IP 地址，子网掩码和默认网关， 这三项配置称为一个网络

* IP 层需要封装了 MAC 层才能将包放入物理层



#### 2. 多个电脑  HUB 集线器

* 集线器完全在物理层工作，将收到的每个字节，都复制到其他的端口


----

### 数据链路层 -- 第二层

> 由于 HUB  采取的是广播模式，如果一台电脑发出的包，其他的电脑都能接受到，就会出现问题


##### MAC 媒体访问控制 ： 控制在发送数据的时候， 先后的问题 ------ 多路访问
> 以太网使用的解决方式 ： 随机接入协--- 有事就出门， 遇到高峰就回去，错过高峰再出




##### MAC 地址（链路层地址）； 解决 发给谁，接收的问题


1. 第二层的网络包格式： 目标的 MAC。和 原的 MAC 地址

![](https://github.com/LiuChuang0059/large_file/blob/master/pic/h0k9n.jpg)

2. 网络包类型 ： IP 数据包（TCP， UDP 以及 HTTP 等）

3. MAC 接收 ：数据包在链路上广播， MAC 网卡 发现接收， 打开 IP 包，发现 IP 地址也是自己的，再打开 TCP ，发现端口也是自己的。

![](https://github.com/LiuChuang0059/large_file/blob/master/pic/zqsww.jpg)

4. 将 请求提交到 nginx，nginx 返回一个网页。再将网页需要发回请求的机器。 层层封装 最后到 MAC 层



##### CRC （循环冗余检查） ： 解决发送错误
> 通过 XOR异或 算法，计算整个包是否在发送的过程中出现了错误


##### ARP 协议 ： 解决 MAC 未知的问题

![](https://github.com/LiuChuang0059/large_file/blob/master/pic/i97ys.jpg)

> 在同一个局域网里面， 查看 ARP 表， 查不到就 广播 ARP 请求，对应的机器做回答
>  为了避免每次都用 ARP 请求， 机器本地 进行 ARP 缓存 IP- MAC的映射列表


----

### Hub -> 交换机

* Hub 是广播的， 所有的Bit 都会发送到接口， 由主机来判断是不是需要。

* 交换机， 通过学习记住每个 MAC 值对应的接口，以后有包的目的地址是相应的 MAC 直接发送到对应的口
> 但是 机器的 IP 地址会发生变化，交换机学习的结果，时效有限



































