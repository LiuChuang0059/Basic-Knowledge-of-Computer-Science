本文为 廖雪峰老师 SQL教程 学习笔记
https://www.liaoxuefeng.com/wiki/1177760294764384

-----

## 1.  SQL 基本

1. SQL ： 结构化查询语言，用来访问和操作数据库系统

2. SQL语言 定义了集中操作数据库的能力：

* DDL ： Data Definition Language

用户定义数据 ： 创建表，删除表， 修改表结构

*  DML： Data Manipulation Language

用户 添加， 删除， 更行数据的 能力

* DQL：Data Query Language

允许用户查询数据，


3. 语法特点 ： 关键字不区分大小写

----

## 2. 关系模型

关系模型本质上是若干个储存数据的二维表。
* 表的每一行称作 record 记录， 记录数据，一条记录是由多个字段组成的
* 每一列称作 字段

字段定义了 数据类型， 以及是否允许 null 。 NULL 表示数据不存在
> 通常情况下，应该避免允许 NULL  ,可以简化查询条件， 加快查询的速度，读取数据后无需判断是否为 NULL


### 1. 主键

对于关系表，任意两条记录不能重复，能够通过某个字段区分出不同的记录，这个字段称为 主键

例如：

| id | name | score |
| :-----| ----: | :----: |
| 1 | liu | 90 |
| 2 | zou | 95 |

如果把 name 字段设定为主键， 通过名字 liu， zou 就可以确定一条记录， 之后不能储存相同名字的同学

**对于主键， 记录一旦插入到表之中，主键最好不要在进行修改**

不使用任何业务相关的字段作为主键： 这个字段一般命名为 id， 常见的 id 字段类型：
> 对用户没有任何意义的数据 ， 任何含有业务含义的列都有改变的可能性，业户的改变会导致很大的维护开销

* 自增整数类型， 数据库在插入数据的时候会自动的微每一条记录分配一个自增整数
> BIGINIT 自增类型允许 922亿亿记录

* GUID 类型， 通过 网卡 MAC 地址，时间戳和随机数保证任意计算机在任意时间生成的字符串都是不一样的

----

### 2. 联合主键

通过多个字段 唯一标识记录， 两个或者更多的字段都设置为主键 --- 联合主键

**联合主键只要主键不完全相同就允许**

尽量不使用联合主键

----

### 3. 外键  实现一对多的关系

1. 通过字段 可以将数据与另一张表关联起来

students 表


| id | name | score |
| :-----| ----: | :----: |
| 1 | liu | 90 |
| 2 | zou | 95 |


clsses 表

| id | name | other |
| :-----| ----: | :----: |
| 1 | 一班 | ... |
| 2 | 二班 | ... |


为了 确定 学生属于哪个班级，  在 students 表中加入 class_id


| id | name | class_id |
| :-----| ----: | :----: |
| 1 | liu | 1 |
| 2 | zou | 2 |
|3| zhang| 1|

class_id 就将studens 和 classes 表关联起来


2. 外键 通过定义外键约束 实现


```sql
AFTER TABLE students
ADD CONSTRAINT fk_class_id   # 外键约束名称，
FOREIGN KEY (class_id)     # 指定 class_id 作为 外键
REFERENCES classes (id);   # 指定 外键 关联到 classes 的 id 列， 主键列
```

* 外键约束会降低数据库的性能

* 删除外键约束

```sql
AFTER TABLE students
DROP FOREIGN KEY fk_class_id;
```



3.  中间表 实现多对多关系

teachers

| id | name |
| :-----| ----: |
| 1 | 刘老师 |
| 2 | 邹老师 |
| 3| 张老师 |



classes ：

| id | name |
| :-----| ----: |
| 1 | 一班 |
| 2 | 二班 |


中间表


| id | teacher_id| class_id |
| :-----| ----: | ----: |
| 1 | 1 |     1 |
| 2 | 1 |     2 |
| 3|  2 |    1|
| 4 | 3 |   1|
| 4 | 3  |  2 |

外键： 中间表上的两个字段都要设置 外键



4. 一对一

一对一的表相当于 表增加一个 列

一些应用 会把一个大的表拆分成两个 一对一的表， 把经常读取喝不经常读取的字段分开，获取更高的性能


----

### 4. 索引


索引：关系数据库对于某一列或者多个列进行预排列的数据结构。之后使用索引，查询的时候不必扫描整个数据库，定位到符合条件。

无论是否创建索引， 都可以进行数据库查询， 只是查询的速度存在差异


| id | name | score | gender |
| :-----| ----: | :----: | : ---: |
| 1 | liu | 90 | M |
| 2 | zou | 95 | F|


1. 经常根据 score 查询， 对 score 列创建索引

```sql
AFTER TABLE students
ADD INDEX id_score(score);
```
创建了一个 名称 id_score  索引是 score 的索引


2. 创建多列的索引
```sql
AFTER TABLE students
ADD INDEX id_score(name, score);

```

* 索引值越散列 ， 索引的效率越高

* 索引的 优点： 提高了查询的效率，

* 索引的 缺点 ： 插入，更新，删除的时候， 需要修改 索引

**主键数据库会自动创建主键索引**


3. 唯一索引

身份证号，邮箱地址， 唯一的列，但是由于具有业务含义， 不适合做主键，但是具有唯一性的约束

```sql
AFTER TABLE students
ADD UNIQUE INDEX id_score(name);
```
这里假设名字不可重复， 这样就添加了一个 唯一索引。



----
# 参考

1. https://blog.csdn.net/cxzhq2002/article/details/4435267




