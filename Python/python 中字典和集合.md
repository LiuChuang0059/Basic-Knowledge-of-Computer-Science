本文为 极客时间 景霄老师 的《python 核心技术与实战》课程 学习笔记

----


## 1. 字典和 集合的基础

1. Python 3.7+ 之后 字典呗确定为有序的； 3.6 中是 无法确保其有序性 ；3.6 之前是无需无序的


2. 字典对于查找， 添加和删除等操作，时间复杂度 O(1)

3. 集合和字典的区别在于 ： 集合没有 key 和 value 的配对，是一系列无序的唯一的元素集合


4. 字典和集合的创建


```python
d1 = {"liu":23, "zou": 13}
d2 = dict({"liu": 23,"zou": 13})

s1 = {1, 2, 3}
s2 = set([1, 2, 3])

```

5. 元素的访问

5-1 字典

通过键 索引， 不存在, 抛出异常

```python

>>> d1 = {"liu":23, "zou": 13}
>>> d2 = dict({"liu": 23,"zou": 13})
>>> d1["liu"]
23

>>> d1['chaung']
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
KeyError: 'chaung'

```

使用 类函数索引， 不存在则可以返回一个默认值

```python
>>> d1.get('liu')
23
>>> d1.get('chuang')
>>> d1.get('chuang','null')
'null'

```

5-2 集合 -- 无序不重复的元素集

** 不支持索引操作，集合的本质是 哈希表**

支持：

```python

x in set # 判断是否在集合里面

for x in set:

len(set)

```

set 不重复的特性， 用来去除 列表中 海量重复的元素

```python
a = [11,22,33,44,11,22]
b = set(a)
a = [i for i in b]
```


6. 字典和集合进行排序

6-1 字典排序

根据 key 或者 根据 value

```python

d = {'b': 1, 'a': 2, 'c': 10}
d_sorted_by_key = sorted(d.items(), key=lambda x: x[0]) # 根据字典键的升序排序
d_sorted_by_value = sorted(d.items(), key=lambda x: x[1]) # 根据字典值的升序排序

>>> d_sorted_by_key
[('a', 2), ('b', 1), ('c', 10)]

```

**排序后 返回的是 列表**

6-2 集合排序

```python
s = {1,3,4,2,6,5}
>>> sorted(s
... )
[1, 2, 3, 4, 5, 6]


```

**同样返回排序好的列表**


----

## 2. 字典和集合的性能


字典和集合是性能高度优化的数据结构，对于查找，删除添加等操作，时间复杂度是 O(1).

字典和集合的内部结构都是一张哈希表

字典： 储存了哈希值，键和值 3 个元素。
集合： 哈希表没有见和值， 只有单一的元素。

为了提高储存空间的利用率， 哈希表除了字典本身的结构，将索引和（ 哈希值，键，值单独分开）

```python
Indices
----------------------------------------------------
None | index | None | None | index | None | index ...
----------------------------------------------------

Entries
--------------------
hash0   key0  value0
---------------------
hash1   key1  value1
---------------------
hash2   key2  value2
---------------------
        ...
---------------------


```



### 1. 插入操作

1. 向字典插入一个元素， python 计算 键值的 Hash ，
2. 计算 mask = PyDicMinSize - 1
3. 计算  index = mask & hash
4. 如果 位置是空的， 插入
5. 如果位置占用 ：
  5-1 ： 两个元素的 哈希值和键值都相同，表明元素已经存在， value 不同， 更新value
  5-2 ： 两者中有一个不相同， 这种时候出现 哈希冲突， hash collision，  python 会继续寻找合适的表中其他的位置


### 2. 查找

给定 key 值， 计算相应的 hash ，找到 相应的 value。


### 3. 删除操作

暂时对这位置的元素赋予一个特殊的值， 重新调整哈希表的大小的时候， 删除。

### 4. 哈希表大小

为了避免冲突， 字典内的哈希表，通常会保证留有 1/3 的剩余空间。
当剩余空间小于 1/3 的时候， Python会重新获取更大的内存空间，扩充哈希表。


### 5. 字典初始化

```python

d = {"liu": 23, "zou ": 13}

d = dict({"liu": 23, "zou ": 13})


```

第一种 初始化效率更高， {} 是关键字， 内部直接调用 底层的 C 的代码


### 6. 字典的 key  不能是一个列表 ， 可以是元组
因为列表 是一个动态变化的数据结构， 字典中的 key 是要求不可以变化的



# 参考

1. Python集合（set）类型的操作-- https://blog.csdn.net/business122/article/details/7541486




